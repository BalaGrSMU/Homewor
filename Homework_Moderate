Sub Homework_Moderate()'Clear all to rerun the macros during testingColumns("I:Q").SelectSelection.Clear'Defining variablesDim x As DoubleDim TotalVolumes As DoubleDim PriceOpen As IntegerDim PriceClose As IntegerDim i As Double 'Create headers for the consolidated reportCells(1, 9).Value = "Stock Ticker"Cells(1, 10).Value = "Yearly change"Cells(1, 11).Value = "Percent Change"Cells(1, 12).Value = "Total Stock Volumes"x = 2Cells(x, 9).Value = Cells(x, 1).ValuePriceOpen = Cells(x, 3).Value'Defining LastRow functionLastRow = Cells(Rows.Count, 1).End(xlUp).Row'Initializing variables'Loop to consolidate TotalVolumes for a StockFor i = 2 To LastRow    If Cells(i, 1).Value = Cells(x, 9).Value Then    TotalVolumes = TotalVolumes + Cells(i, 7).Value    'PriceOpen = Cells(i, 3).Value    PriceClose = Cells(i, 6).Value    Else    Cells(x, 10).Value = PriceClose - PriceOpen        If PriceClose <= 0 Then            Cells(x, 11).Value = 0        Else        Cells(x, 11).Value = (PriceClose / PriceOpen) - 1        End If        Cells(x, 11).Style = "Percent"     If Cells(x, 10).Value >= 0 Then        Cells(x, 10).Interior.ColorIndex = 4        Else        Cells(x, 10).Interior.ColorIndex = 3     End If    Cells(x, 12).Value = TotalVolumes    TotalVolumes = Cells(i, 7).Value    x = x + 1    Cells(x, 9).Value = Cells(i, 1).Value    PriceOpen = Cells(i, 3).Value    End IfNext iCells(x, 10).Value = PriceClose - PriceOpen    If PriceClose <= 0 Then        Cells(x, 11).Value = 0    Else        Cells(x, 11).Value = (PriceClose / PriceOpen) - 1    End If    Cells(x, 11).Style = "Percent"    If Cells(x, 10).Value >= 0 Then        Cells(x, 10).Interior.ColorIndex = 4        Else        Cells(x, 10).Interior.ColorIndex = 3    End If    Cells(x, 11).Style = "Percent"Cells(x, 12).Value = TotalVolumes'resize columns and position cursor in Cells(1,1)Columns("I:Q").EntireColumn.AutoFitCells(1, 1).SelectEnd Sub